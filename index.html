<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercises</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/prism.css" />
    <link rel="stylesheet" href="css/custom.css" />
  </head>
  <body>
    <main>
      <section>
        <h2>Ã˜velse 1</h2>

        <figure>
          <img src="img/grid-exercise-1.webp" alt="" />
          <figcaption>
            <p>Lav 3 kolonner, som er lige brede.</p>
            <ul class="hints">
              <li><code>grid-template-columns</code> (property)</li>
              <li><code>fr</code> (enhed)</li>
            </ul>
          </figcaption>
        </figure>

        <article class="output">
          <div class="ex1">
            <div class="box box-1" contenteditable></div>
            <div class="box box-2" contenteditable></div>
            <div class="box box-3" contenteditable></div>
            <div class="box box-4" contenteditable></div>
            <div class="box box-5" contenteditable></div>
            <div class="box box-6" contenteditable></div>
            <div class="box box-7" contenteditable></div>
            <div class="box box-8" contenteditable></div>
            <div class="box box-9" contenteditable></div>
          </div>
        </article>

        <div class="editor">
          <textarea class="prism-live language-css">
.ex1 {
  
}</textarea
          >
          <style class="style"></style>
        </div>
      </section>

      <section>
        <h2>Test</h2>

        <article class="output">
          <div class="ex2">
            <div class="box box-1" contenteditable></div>
            <div class="box box-2" contenteditable></div>
            <div class="box box-3" contenteditable></div>
            <div class="box box-4" contenteditable></div>
            <div class="box box-5" contenteditable></div>
            <div class="box box-6" contenteditable></div>
            <div class="box box-7" contenteditable></div>
            <div class="box box-8" contenteditable></div>
            <div class="box box-9" contenteditable></div>
          </div>
        </article>

        <div class="editor">
          <textarea class="prism-live language-css">/* .ex2 */</textarea>
          <style class="style"></style>
        </div>
      </section>
    </main>

    <script src="js/prism.js"></script>
    <script src="js/prism-live.js?load=css"></script>
    <script>
      const sections = document.querySelectorAll("section");
      const classReg = /(\.[a-z])/gi;

      sections.forEach((section, i) => {
        const styleTag = section.querySelector(".editor > style");
        const _tA = section.querySelector(".editor > textarea");
        const storageKey = `exercise-${i + 1}`;

        const init = () => {
          const parentClass =
            "parent-" + section.querySelector("article>div").className;
          section.classList.add(parentClass);
          function prefix(str) {
            return str.replaceAll(
              classReg,
              (match) => `.${parentClass} ${match}`
            );
          }
          if (localStorage.getItem(storageKey)) {
            _tA.value = localStorage.getItem(storageKey);

            styleTag.innerHTML = prefix(_tA.value);
          }

          _tA.addEventListener("input", (e) => {
            styleTag.innerHTML = prefix(e.target.value);
            localStorage.setItem(storageKey, _tA.value);
          });
        };

        init();
      });
    </script>
  </body>
</html>
